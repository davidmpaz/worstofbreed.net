---
const pathname = Astro.url.pathname;

// Helper to check if a link is active
// We remove trailing slashes for comparison to avoid "fuzzy matches"
const cleanPath = pathname.replace(/\/$/, "");

const navItems = [
  {
    label: "Home",
    path: `/`,
    isActive: cleanPath === `/`,
  },
  {
    label: "Design Patterns",
    path: `/patterns`,
    isActive: cleanPath.startsWith(`/patterns`),
  },
  //   {
  //     label: 'RUBE GOLDBERG AUTOMATION',
  //     path: `/automation`,
  //     isActive: cleanPath.startsWith(`/automation`)
  //   },
  {
    label: "Tech Horror Radar",
    path: `/radar`,
    isActive: cleanPath.startsWith(`/radar`),
  },
];
---

<nav class="brutalist-nav">
  {
    navItems.map((item) => (
      <a href={item.path} class={`nav-item ${item.isActive ? "active" : ""}`}>
        <span class="bracket">[</span>
        {item.label}
        <span class="bracket">]</span>
      </a>
    ))
  }
</nav>

<style>
  /* --- BRUTALIST NAV STYLES --- */
  .brutalist-nav {
    display: flex;
    flex-wrap: wrap; /* Wrap on mobile */
    border: var(--border-thick);
    background: var(--paper);
    margin-bottom: var(--spacing-xl);
    box-shadow: 8px 8px 0 var(--shadow);
    font-family: var(--font-mono);
  }

  .nav-item {
    flex: 1 1 auto; /* Allow grow and shrink, auto basis */
    text-align: center;
    padding: 15px 10px;
    text-decoration: none;
    color: var(--ink);
    font-weight: bold;
    border-right: var(--border-thick);
    border-bottom: var(
      --border-thick
    ); /* Default bottom border for mobile stacked items */
    min-width: 100%; /* Full width on mobile by default */
    transition: all 0.1s;
    text-transform: uppercase;
    font-size: 0.9rem;
  }

  @media (min-width: 768px) {
    .nav-item {
      min-width: auto;
      border-bottom: none; /* Reset bottom border for desktop */
    }

    /* Last item on desktop shouldn't have right border */
    .nav-item:last-child {
      border-right: none;
    }
  }

  /* The last item never has a border-bottom in the stacked state, 
     but care must be taken in desktop mode. */
  .nav-item:last-of-type {
    border-bottom: none;
  }

  /* Hover effect: Neon */
  .nav-item:hover {
    background: var(--accent);
    color: #000;
  }

  /* Active State: Inverted (Black on White) */
  .nav-item.active {
    background: var(--ink);
    color: var(--paper);
  }

  .nav-item.active:hover {
    background: var(--ink); /* No hover on active item */
  }

  /* We normally hide the brackets [], but show them on hover/active */
  .bracket {
    opacity: 0;
    transition: opacity 0.2s;
  }
  .nav-item:hover .bracket,
  .nav-item.active .bracket {
    opacity: 1;
    color: var(--accent);
  }
  .nav-item.active .bracket {
    color: var(--paper);
  } /* White when active */
</style>
